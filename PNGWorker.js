addEventListener('message', function(e) {
    if (e.data == 'name') {
        postMessage('PNGWorker');
        return;
    }
    processFile(e.data);
}, false);

function processFile(sXML) {
    parser = new DOMImplementation();    
    dom = parser.loadXML(sXML);    
    domtoimage.toPng(dom)
        .then(function(dataUrl) {
            postMessage(dataUrl);            
        })
        .catch(function(error) {
            console.log("!");
            console.log('')                
            console.error('oops, something went wrong!', error);
        });    
}


//domtoimage
!function(e){"use strict";function n(e,n){return n=n||{},Promise.resolve(e).then(function(e){return o(e,n.filter,!0)}).then(i).then(u).then(function(e){return n.bgcolor&&(e.style.backgroundColor=n.bgcolor),e}).then(function(n){return c(n,e.scrollWidth,e.scrollHeight)})}function t(e,n){return a(e,n||{}).then(function(e){return e.toDataURL()})}function r(e,n){return a(e,n||{}).then(m.canvasToBlob)}function o(n,t,r){function i(e){return e instanceof HTMLCanvasElement?m.makeImage(e.toDataURL()):e.cloneNode(!1)}function u(e,n,t){function r(e,n,t){var r=Promise.resolve();return n.forEach(function(n){r=r.then(function(){return o(n,t)}).then(function(n){n&&e.appendChild(n)})}),r}var i=e.childNodes;return 0===i.length?Promise.resolve(n):r(n,m.asArray(i),t).then(function(){return n})}function c(n,t){function r(){function r(e,n){function t(e,n){m.asArray(e).forEach(function(t){n.setProperty(t,e.getPropertyValue(t),e.getPropertyPriority(t))})}e.cssText?n.cssText=e.cssText:t(e,n)}r(e.window.getComputedStyle(n),t.style)}function o(){function r(r){function o(n,t,r){function o(e){var n=e.getPropertyValue("content");return e.cssText+" content: "+n+";"}function i(e){function n(n){return n+": "+e.getPropertyValue(n)+(e.getPropertyPriority(n)?" !important":"")}return m.asArray(e).map(n).join("; ")+";"}var u="."+n+":"+t,c=r.cssText?o(r):i(r);return e.document.createTextNode(u+"{"+c+"}")}var i=e.window.getComputedStyle(n,r),u=i.getPropertyValue("content");if(""!==u&&"none"!==u){var c=m.uid();t.className=t.className+" "+c;var a=e.document.createElement("style");a.appendChild(o(c,r,i)),t.appendChild(a)}}[":before",":after"].forEach(function(e){r(e)})}function i(){n instanceof HTMLTextAreaElement&&(t.innerHTML=n.value),n instanceof HTMLInputElement&&t.setAttribute("value",n.value)}function u(){t instanceof SVGElement&&(t.setAttribute("xmlns","http://www.w3.org/2000/svg"),t instanceof SVGRectElement&&["width","height"].forEach(function(e){var n=t.getAttribute(e);n&&t.style.setProperty(e,n)}))}return t instanceof Element?Promise.resolve().then(r).then(o).then(i).then(u).then(function(){return t}):t}return r||!t||t(n)?Promise.resolve(n).then(i).then(function(e){return u(n,e,t)}).then(function(e){return c(n,e)}):Promise.resolve()}function i(e){return g.resolveAll().then(function(n){var t=document.createElement("style");return e.appendChild(t),t.appendChild(document.createTextNode(n)),e})}function u(e){return p.inlineAll(e).then(function(){return e})}function c(e,n,t){return Promise.resolve(e).then(function(e){return e.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),(new XMLSerializer).serializeToString(e)}).then(m.escapeXhtml).then(function(e){return'<foreignObject x="0" y="0" width="100%" height="100%">'+e+"</foreignObject>"}).then(function(e){return'<svg xmlns="http://www.w3.org/2000/svg" width="'+n+'" height="'+t+'">'+e+"</svg>"}).then(function(e){return"data:image/svg+xml;charset=utf-8,"+e})}function a(e,t){function r(e){var n=document.createElement("canvas");return n.width=e.scrollWidth,n.height=e.scrollHeight,n}return n(e,t).then(m.makeImage).then(m.delay(100)).then(function(n){var t=r(e);return t.getContext("2d").drawImage(n,0,0),t})}function s(){function n(){var e="application/font-woff",n="image/jpeg";return{woff:e,woff2:e,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:n,jpeg:n,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"}}function t(e){var n=/\.([^\.\/]*?)$/g.exec(e);return n?n[1]:""}function r(e){var r=t(e).toLowerCase();return n()[r]||""}function o(e){return-1!==e.search(/^(data:)/)}function i(e){return new Promise(function(n){for(var t=window.atob(e.toDataURL().split(",")[1]),r=t.length,o=new Uint8Array(r),i=0;r>i;i++)o[i]=t.charCodeAt(i);n(new Blob([o],{type:"image/png"}))})}function u(e){return e.toBlob?new Promise(function(n){e.toBlob(n)}):i(e)}function c(n,t){var r=e.document.implementation.createHTMLDocument(),o=r.createElement("base");r.head.appendChild(o);var i=r.createElement("a");return r.body.appendChild(i),o.href=t,i.href=n,i.href}function a(){var e=0;return function(){function n(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)}return"u"+n()+e++}}function s(e){return new Promise(function(n,t){var r=new Image;r.onload=function(){n(r)},r.onerror=t,r.src=e})}function l(e){var n=3e4;return new Promise(function(t){function r(){if(4===u.readyState){if(200!==u.status)return void i("cannot fetch resource: "+e+", status: "+u.status);var n=new FileReader;n.onloadend=function(){var e=n.result.split(/,/)[1];t(e)},n.readAsDataURL(u.response)}}function o(){i("timeout of "+n+"ms occured while fetching resource: "+e)}function i(e){console.error(e),t("")}var u=new XMLHttpRequest;u.onreadystatechange=r,u.ontimeout=o,u.responseType="blob",u.timeout=n,u.open("GET",e,!0),u.send()})}function f(e,n){return"data:"+n+";base64,"+e}function h(e){return e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")}function m(e){return function(n){return new Promise(function(t){setTimeout(function(){t(n)},e)})}}function d(e){for(var n=[],t=e.length,r=0;t>r;r++)n.push(e[r]);return n}function g(e){return e.replace(/#/g,"%23").replace(/\n/g,"%0A")}return{escape:h,parseExtension:t,mimeType:r,dataAsUrl:f,isDataUrl:o,canvasToBlob:u,resolveUrl:c,getAndEncode:l,uid:a(),delay:m,asArray:d,escapeXhtml:g,makeImage:s}}function l(){function e(e){return-1!==e.search(o)}function n(e){for(var n,t=[];null!==(n=o.exec(e));)t.push(n[1]);return t.filter(function(e){return!m.isDataUrl(e)})}function t(e,n,t,r){function o(e){return new RegExp("(url\\(['\"]?)("+m.escape(e)+")(['\"]?\\))","g")}return Promise.resolve(n).then(function(e){return t?m.resolveUrl(e,t):e}).then(r||m.getAndEncode).then(function(e){return m.dataAsUrl(e,m.mimeType(n))}).then(function(t){return e.replace(o(n),"$1"+t+"$3")})}function r(r,o,i){function u(){return!e(r)}return u()?Promise.resolve(r):Promise.resolve(r).then(n).then(function(e){var n=Promise.resolve(r);return e.forEach(function(e){n=n.then(function(n){return t(n,e,o,i)})}),n})}var o=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:r,shouldProcess:e,impl:{readUrls:n,inline:t}}}function f(){function e(){return n(document).then(function(e){return Promise.all(e.map(function(e){return e.resolve()}))}).then(function(e){return e.join("\n")})}function n(){function e(e){return e.filter(function(e){return e.type===CSSRule.FONT_FACE_RULE}).filter(function(e){return d.shouldProcess(e.style.getPropertyValue("src"))})}function n(e){var n=[];return e.forEach(function(e){try{m.asArray(e.cssRules||[]).forEach(n.push.bind(n))}catch(t){console.log("Error while reading CSS rules from "+e.href,t.toString())}}),n}function t(e){return{resolve:function(){var n=(e.parentStyleSheet||{}).href;return d.inlineAll(e.cssText,n)},src:function(){return e.style.getPropertyValue("src")}}}return Promise.resolve(m.asArray(document.styleSheets)).then(n).then(e).then(function(e){return e.map(t)})}return{resolveAll:e,impl:{readAll:n}}}function h(){function e(e){function n(n){return m.isDataUrl(e.src)?Promise.resolve():Promise.resolve(e.src).then(n||m.getAndEncode).then(function(n){return m.dataAsUrl(n,m.mimeType(e.src))}).then(function(n){return new Promise(function(t,r){e.onload=t,e.onerror=r,e.src=n})})}return{inline:n}}function n(t){function r(e){var n=e.style.getPropertyValue("background");return n?d.inlineAll(n).then(function(n){e.style.setProperty("background",n,e.style.getPropertyPriority("background"))}).then(function(){return e}):Promise.resolve(e)}return t instanceof Element?r(t).then(function(){return t instanceof HTMLImageElement?e(t).inline():Promise.all(m.asArray(t.childNodes).map(function(e){return n(e)}))}):Promise.resolve(t)}return{inlineAll:n,impl:{newImage:e}}}var m=s(),d=l(),g=f(),p=h();e.domtoimage={toSvg:n,toPng:t,toBlob:r,impl:{fontFaces:g,images:p,util:m,inliner:d}}}(this);

//xml parser
function addClass(e,t){return e?e.indexOf("|"+t+"|")<0&&(e+=t+"|"):e="|"+t+"|",e}DOMException=function(e){this._class=addClass(this._class,"DOMException"),this.code=e},DOMException.INDEX_SIZE_ERR=1,DOMException.DOMSTRING_SIZE_ERR=2,DOMException.HIERARCHY_REQUEST_ERR=3,DOMException.WRONG_DOCUMENT_ERR=4,DOMException.INVALID_CHARACTER_ERR=5,DOMException.NO_DATA_ALLOWED_ERR=6,DOMException.NO_MODIFICATION_ALLOWED_ERR=7,DOMException.NOT_FOUND_ERR=8,DOMException.NOT_SUPPORTED_ERR=9,DOMException.INUSE_ATTRIBUTE_ERR=10,DOMException.INVALID_STATE_ERR=11,DOMException.SYNTAX_ERR=12,DOMException.INVALID_MODIFICATION_ERR=13,DOMException.NAMESPACE_ERR=14,DOMException.INVALID_ACCESS_ERR=15,DOMImplementation=function(){this._class=addClass(this._class,"DOMImplementation"),this._p=null,this.preserveWhiteSpace=!1,this.namespaceAware=!0,this.errorChecking=!0},DOMImplementation.prototype.escapeString=function(e){return __escapeString(e)},DOMImplementation.prototype.unescapeString=function(e){return __unescapeString(e)},DOMImplementation.prototype.hasFeature=function(e,t){var n=!1;return"xml"==e.toLowerCase()?n=!t||"1.0"==t||"2.0"==t:"core"==e.toLowerCase()&&(n=!t||"2.0"==t),n},DOMImplementation.prototype.loadXML=function(e){var t;try{t=new XMLP(e)}catch(n){alert("Error Creating the SAX Parser. Did you include xmlsax.js or tinyxmlsax.js in your web page?\nThe SAX parser is needed to populate XML for <SCRIPT>'s W3C DOM Parser with data.")}var i=new DOMDocument(this);return this._parseLoop(i,t),i._parseComplete=!0,i},DOMImplementation.prototype.translateErrCode=function(e){var t="";switch(e){case DOMException.INDEX_SIZE_ERR:t="INDEX_SIZE_ERR: Index out of bounds";break;case DOMException.DOMSTRING_SIZE_ERR:t="DOMSTRING_SIZE_ERR: The resulting string is too long to fit in a DOMString";break;case DOMException.HIERARCHY_REQUEST_ERR:t="HIERARCHY_REQUEST_ERR: The Node can not be inserted at this location";break;case DOMException.WRONG_DOCUMENT_ERR:t="WRONG_DOCUMENT_ERR: The source and the destination Documents are not the same";break;case DOMException.INVALID_CHARACTER_ERR:t="INVALID_CHARACTER_ERR: The string contains an invalid character";break;case DOMException.NO_DATA_ALLOWED_ERR:t="NO_DATA_ALLOWED_ERR: This Node / NodeList does not support data";break;case DOMException.NO_MODIFICATION_ALLOWED_ERR:t="NO_MODIFICATION_ALLOWED_ERR: This object cannot be modified";break;case DOMException.NOT_FOUND_ERR:t="NOT_FOUND_ERR: The item cannot be found";break;case DOMException.NOT_SUPPORTED_ERR:t="NOT_SUPPORTED_ERR: This implementation does not support function";break;case DOMException.INUSE_ATTRIBUTE_ERR:t="INUSE_ATTRIBUTE_ERR: The Attribute has already been assigned to another Element";break;case DOMException.INVALID_STATE_ERR:t="INVALID_STATE_ERR: The object is no longer usable";break;case DOMException.SYNTAX_ERR:t="SYNTAX_ERR: Syntax error";break;case DOMException.INVALID_MODIFICATION_ERR:t="INVALID_MODIFICATION_ERR: Cannot change the type of the object";break;case DOMException.NAMESPACE_ERR:t="NAMESPACE_ERR: The namespace declaration is incorrect";break;case DOMException.INVALID_ACCESS_ERR:t="INVALID_ACCESS_ERR: The object does not support this function";break;default:t="UNKNOWN: Unknown Exception Code ("+e+")"}return t},DOMImplementation.prototype._parseLoop=function(e,t){var n,i,o,r;iNodeParent=e;var s=new Array,a=new Array;if(this.namespaceAware){var h=e.createNamespace("");h.setValue("http://www.w3.org/2000/xmlns/"),e._namespaces.setNamedItem(h)}for(;;)if(n=t.next(),n==XMLP._ELM_B){var d=t.getName();if(d=trim(d,!0,!0),this.namespaceAware){i=e.createElementNS("",t.getName()),i._namespaces=iNodeParent._namespaces._cloneNodes(i);for(var c=0;c<t.getAttributeCount();c++)if(r=t.getAttributeName(c),this._isNamespaceDeclaration(r)){this._parseNSName(r);h="xmlns"!=r?e.createNamespace(r):e.createNamespace(""),h.setValue(t.getAttributeValue(c)),i._namespaces.setNamedItem(h)}else o=i.getAttributeNode(r),o||(o=e.createAttributeNS("",r)),o.setValue(t.getAttributeValue(c)),i.setAttributeNodeNS(o),this._isIdDeclaration(r)&&(i.id=t.getAttributeValue(c));i._namespaces.getNamedItem(i.prefix)&&(i.namespaceURI=i._namespaces.getNamedItem(i.prefix).value);for(var c=0;c<i.attributes.length;c++)""!=i.attributes.item(c).prefix&&i._namespaces.getNamedItem(i.attributes.item(c).prefix)&&(i.attributes.item(c).namespaceURI=i._namespaces.getNamedItem(i.attributes.item(c).prefix).value)}else{i=e.createElement(t.getName());for(var c=0;c<t.getAttributeCount();c++)r=t.getAttributeName(c),o=i.getAttributeNode(r),o||(o=e.createAttribute(r)),o.setValue(t.getAttributeValue(c)),i.setAttributeNode(o)}iNodeParent.nodeType==DOMNode.DOCUMENT_NODE&&(iNodeParent.documentElement=i),iNodeParent.appendChild(i),iNodeParent=i}else if(n==XMLP._ELM_E)iNodeParent=iNodeParent.parentNode;else if(n==XMLP._ELM_EMP){if(d=t.getName(),d=trim(d,!0,!0),this.namespaceAware){i=e.createElementNS("",t.getName()),i._namespaces=iNodeParent._namespaces._cloneNodes(i);for(var c=0;c<t.getAttributeCount();c++)if(r=t.getAttributeName(c),this._isNamespaceDeclaration(r)){this._parseNSName(r);h="xmlns"!=r?e.createNamespace(r):e.createNamespace(""),h.setValue(t.getAttributeValue(c)),i._namespaces.setNamedItem(h)}else o=i.getAttributeNode(r),o||(o=e.createAttributeNS("",r)),o.setValue(t.getAttributeValue(c)),i.setAttributeNodeNS(o),this._isIdDeclaration(r)&&(i.id=t.getAttributeValue(c));i._namespaces.getNamedItem(i.prefix)&&(i.namespaceURI=i._namespaces.getNamedItem(i.prefix).value);for(var c=0;c<i.attributes.length;c++)""!=i.attributes.item(c).prefix&&i._namespaces.getNamedItem(i.attributes.item(c).prefix)&&(i.attributes.item(c).namespaceURI=i._namespaces.getNamedItem(i.attributes.item(c).prefix).value)}else{i=e.createElement(d);for(var c=0;c<t.getAttributeCount();c++)r=t.getAttributeName(c),o=i.getAttributeNode(r),o||(o=e.createAttribute(r)),o.setValue(t.getAttributeValue(c)),i.setAttributeNode(o)}iNodeParent.nodeType==DOMNode.DOCUMENT_NODE&&(iNodeParent.documentElement=i),iNodeParent.appendChild(i)}else if(n==XMLP._TEXT||n==XMLP._ENTITY){var p=t.getContent().substring(t.getContentBegin(),t.getContentEnd());if(this.preserveWhiteSpace||""==trim(p,!0,!0)&&(p=""),p.length>0){var l=e.createTextNode(p);iNodeParent.appendChild(l),n==XMLP._ENTITY?s[s.length]=l:a[a.length]=l}}else if(n==XMLP._PI)iNodeParent.appendChild(e.createProcessingInstruction(t.getName(),t.getContent().substring(t.getContentBegin(),t.getContentEnd())));else if(n==XMLP._CDATA)p=t.getContent().substring(t.getContentBegin(),t.getContentEnd()),this.preserveWhiteSpace||(p=trim(p,!0,!0),p.replace(/ +/g," ")),p.length>0&&iNodeParent.appendChild(e.createCDATASection(p));else if(n==XMLP._COMMENT){var p=t.getContent().substring(t.getContentBegin(),t.getContentEnd());this.preserveWhiteSpace||(p=trim(p,!0,!0),p.replace(/ +/g," ")),p.length>0&&iNodeParent.appendChild(e.createComment(p))}else if(n==XMLP._DTD);else{if(n==XMLP._ERROR)throw new DOMException(DOMException.SYNTAX_ERR);if(n==XMLP._NONE){if(iNodeParent==e)break;throw new DOMException(DOMException.SYNTAX_ERR)}}var D=s.length;for(intLoop=0;intLoop<D;intLoop++){var N=s[intLoop],m=N.getParentNode();if(m&&(m.normalize(),!this.preserveWhiteSpace)){var u=m.getChildNodes(),O=u.getLength();for(intLoop2=0;intLoop2<O;intLoop2++){var _=u.item(intLoop2);if(_.getNodeType()==DOMNode.TEXT_NODE){var E=_.getData();E=trim(E,!0,!0),E.replace(/ +/g," "),_.setData(E)}}}}if(!this.preserveWhiteSpace){var D=a.length;for(intLoop=0;intLoop<D;intLoop++){var M=a[intLoop];if(null!=M.getParentNode()){var g=M.getData();g=trim(g,!0,!0),g.replace(/ +/g," "),M.setData(g)}}}},DOMImplementation.prototype._isNamespaceDeclaration=function(e){return e.indexOf("xmlns")>-1},DOMImplementation.prototype._isIdDeclaration=function(e){return"id"==e.toLowerCase()},DOMImplementation.prototype._isValidName=function(e){return e.match(re_validName)},re_validName=/^[a-zA-Z_:][a-zA-Z0-9\.\-_:]*$/,DOMImplementation.prototype._isValidString=function(e){return e.search(re_invalidStringChars)<0},re_invalidStringChars=/\x01|\x02|\x03|\x04|\x05|\x06|\x07|\x08|\x0B|\x0C|\x0E|\x0F|\x10|\x11|\x12|\x13|\x14|\x15|\x16|\x17|\x18|\x19|\x1A|\x1B|\x1C|\x1D|\x1E|\x1F|\x7F/,DOMImplementation.prototype._parseNSName=function(e){var t=new Object;return t.prefix=e,t.namespaceName="",delimPos=e.indexOf(":"),delimPos>-1&&(t.prefix=e.substring(0,delimPos),t.namespaceName=e.substring(delimPos+1,e.length)),t},DOMImplementation.prototype._parseQName=function(e){var t=new Object;return t.localName=e,t.prefix="",delimPos=e.indexOf(":"),delimPos>-1&&(t.prefix=e.substring(0,delimPos),t.localName=e.substring(delimPos+1,e.length)),t},DOMNodeList=function(e,t){this._class=addClass(this._class,"DOMNodeList"),this._nodes=new Array,this.length=0,this.parentNode=t,this.ownerDocument=e,this._readonly=!1},DOMNodeList.prototype.getLength=function(){return this.length},DOMNodeList.prototype.item=function(e){var t=null;return e>=0&&e<this._nodes.length&&(t=this._nodes[e]),t},DOMNodeList.prototype._findItemIndex=function(e){var t=-1;if(e>-1)for(var n=0;n<this._nodes.length;n++)if(this._nodes[n]._id==e){t=n;break}return t},DOMNodeList.prototype._insertBefore=function(e,t){if(t>=0&&t<this._nodes.length){var n=new Array;n=this._nodes.slice(0,t),e.nodeType==DOMNode.DOCUMENT_FRAGMENT_NODE?n=n.concat(e.childNodes._nodes):n[n.length]=e,this._nodes=n.concat(this._nodes.slice(t)),this.length=this._nodes.length}},DOMNodeList.prototype._replaceChild=function(e,t){var n=null;if(t>=0&&t<this._nodes.length)if(n=this._nodes[t],e.nodeType==DOMNode.DOCUMENT_FRAGMENT_NODE){var i=new Array;i=this._nodes.slice(0,t),i=i.concat(e.childNodes._nodes),this._nodes=i.concat(this._nodes.slice(t+1))}else this._nodes[t]=e;return n},DOMNodeList.prototype._removeChild=function(e){var t=null;if(e>-1){t=this._nodes[e];var n=new Array;n=this._nodes.slice(0,e),this._nodes=n.concat(this._nodes.slice(e+1)),this.length=this._nodes.length}return t},DOMNodeList.prototype._appendChild=function(e){e.nodeType==DOMNode.DOCUMENT_FRAGMENT_NODE?this._nodes=this._nodes.concat(e.childNodes._nodes):this._nodes[this._nodes.length]=e,this.length=this._nodes.length},DOMNodeList.prototype._cloneNodes=function(e,t){for(var n=new DOMNodeList(this.ownerDocument,t),i=0;i<this._nodes.length;i++)n._appendChild(this._nodes[i].cloneNode(e));return n},DOMNodeList.prototype.toString=function(){for(var e="",t=0;t<this.length;t++)e+=this._nodes[t].toString();return e},DOMNamedNodeMap=function(e,t){this._class=addClass(this._class,"DOMNamedNodeMap"),this.DOMNodeList=DOMNodeList,this.DOMNodeList(e,t)},DOMNamedNodeMap.prototype=new DOMNodeList,DOMNamedNodeMap.prototype.getNamedItem=function(e){var t=null,n=this._findNamedItemIndex(e);return n>-1&&(t=this._nodes[n]),t},DOMNamedNodeMap.prototype.setNamedItem=function(e){if(this.ownerDocument.implementation.errorChecking){if(this.ownerDocument!=e.ownerDocument)throw new DOMException(DOMException.WRONG_DOCUMENT_ERR);if(this._readonly||this.parentNode&&this.parentNode._readonly)throw new DOMException(DOMException.NO_MODIFICATION_ALLOWED_ERR);if(e.ownerElement&&e.ownerElement!=this.parentNode)throw new DOMException(DOMException.INUSE_ATTRIBUTE_ERR)}var t=this._findNamedItemIndex(e.name),n=null;if(t>-1){if(n=this._nodes[t],this.ownerDocument.implementation.errorChecking&&n._readonly)throw new DOMException(DOMException.NO_MODIFICATION_ALLOWED_ERR);this._nodes[t]=e}else this._nodes[this.length]=e;return this.length=this._nodes.length,e.ownerElement=this.parentNode,n},DOMNamedNodeMap.prototype.removeNamedItem=function(e){if(this.ownerDocument.implementation.errorChecking&&(this._readonly||this.parentNode&&this.parentNode._readonly))throw new DOMException(DOMException.NO_MODIFICATION_ALLOWED_ERR);var t=this._findNamedItemIndex(e);if(this.ownerDocument.implementation.errorChecking&&0>t)throw new DOMException(DOMException.NOT_FOUND_ERR);var n=this._nodes[t];if(this.ownerDocument.implementation.errorChecking&&n._readonly)throw new DOMException(DOMException.NO_MODIFICATION_ALLOWED_ERR);return this._removeChild(t)},DOMNamedNodeMap.prototype.getNamedItemNS=function(e,t){var n=null,i=this._findNamedItemNSIndex(e,t);return i>-1&&(n=this._nodes[i]),n},DOMNamedNodeMap.prototype.setNamedItemNS=function(e){if(this.ownerDocument.implementation.errorChecking){if(this._readonly||this.parentNode&&this.parentNode._readonly)throw new DOMException(DOMException.NO_MODIFICATION_ALLOWED_ERR);if(this.ownerDocument!=e.ownerDocument)throw new DOMException(DOMException.WRONG_DOCUMENT_ERR);if(e.ownerElement&&e.ownerElement!=this.parentNode)throw new DOMException(DOMException.INUSE_ATTRIBUTE_ERR)}var t=this._findNamedItemNSIndex(e.namespaceURI,e.localName),n=null;if(t>-1){if(n=this._nodes[t],this.ownerDocument.implementation.errorChecking&&n._readonly)throw new DOMException(DOMException.NO_MODIFICATION_ALLOWED_ERR);this._nodes[t]=e}else this._nodes[this.length]=e;return this.length=this._nodes.length,e.ownerElement=this.parentNode,n},DOMNamedNodeMap.prototype.removeNamedItemNS=function(e,t){if(this.ownerDocument.implementation.errorChecking&&(this._readonly||this.parentNode&&this.parentNode._readonly))throw new DOMException(DOMException.NO_MODIFICATION_ALLOWED_ERR);var n=this._findNamedItemNSIndex(e,t);if(this.ownerDocument.implementation.errorChecking&&0>n)throw new DOMException(DOMException.NOT_FOUND_ERR);var i=this._nodes[n];if(this.ownerDocument.implementation.errorChecking&&i._readonly)throw new DOMException(DOMException.NO_MODIFICATION_ALLOWED_ERR);return this._removeChild(n)},DOMNamedNodeMap.prototype._findNamedItemIndex=function(e){for(var t=-1,n=0;n<this._nodes.length;n++)if(this._nodes[n].name==e){t=n;break}return t},DOMNamedNodeMap.prototype._findNamedItemNSIndex=function(e,t){var n=-1;if(t)for(var i=0;i<this._nodes.length;i++)if(this._nodes[i].namespaceURI==e&&this._nodes[i].localName==t){n=i;break}return n},DOMNamedNodeMap.prototype._hasAttribute=function(e){var t=!1,n=this._findNamedItemIndex(e);return n>-1&&(t=!0),t},DOMNamedNodeMap.prototype._hasAttributeNS=function(e,t){var n=!1,i=this._findNamedItemNSIndex(e,t);return i>-1&&(n=!0),n},DOMNamedNodeMap.prototype._cloneNodes=function(e){for(var t=new DOMNamedNodeMap(this.ownerDocument,e),n=0;n<this._nodes.length;n++)t._appendChild(this._nodes[n].cloneNode(!1));return t},DOMNamedNodeMap.prototype.toString=function(){for(var e="",t=0;t<this.length-1;t++)e+=this._nodes[t].toString()+" ";return this.length>0&&(e+=this._nodes[this.length-1].toString()),e},DOMNamespaceNodeMap=function(e,t){this._class=addClass(this._class,"DOMNamespaceNodeMap"),this.DOMNamedNodeMap=DOMNamedNodeMap,this.DOMNamedNodeMap(e,t)},DOMNamespaceNodeMap.prototype=new DOMNamedNodeMap,DOMNamespaceNodeMap.prototype._findNamedItemIndex=function(e){for(var t=-1,n=0;n<this._nodes.length;n++)if(this._nodes[n].localName==e){t=n;break}return t},DOMNamespaceNodeMap.prototype._cloneNodes=function(e){for(var t=new DOMNamespaceNodeMap(this.ownerDocument,e),n=0;n<this._nodes.length;n++)t._appendChild(this._nodes[n].cloneNode(!1));return t},DOMNamespaceNodeMap.prototype.toString=function(){for(var e="",t=0;t<this._nodes.length;t++){var n=null;try{var n=this.parentNode.parentNode._namespaces.getNamedItem(this._nodes[t].localName)}catch(i){break}n&&""+n.nodeValue==""+this._nodes[t].nodeValue||(e+=this._nodes[t].toString()+" ")}return e},DOMNode=function(e){this._class=addClass(this._class,"DOMNode"),e&&(this._id=e._genId()),this.namespaceURI="",this.prefix="",this.localName="",this.nodeName="",this.nodeValue="",this.nodeType=0,this.parentNode=null,this.childNodes=new DOMNodeList(e,this),this.firstChild=null,this.lastChild=null,this.previousSibling=null,this.nextSibling=null,this.attributes=new DOMNamedNodeMap(e,this),this.ownerDocument=e,this._namespaces=new DOMNamespaceNodeMap(e,this),this._readonly=!1},DOMNode.ELEMENT_NODE=1,DOMNode.ATTRIBUTE_NODE=2,DOMNode.TEXT_NODE=3,DOMNode.CDATA_SECTION_NODE=4,DOMNode.ENTITY_REFERENCE_NODE=5,DOMNode.ENTITY_NODE=6,DOMNode.PROCESSING_INSTRUCTION_NODE=7,DOMNode.COMMENT_NODE=8,DOMNode.DOCUMENT_NODE=9,DOMNode.DOCUMENT_TYPE_NODE=10,DOMNode.DOCUMENT_FRAGMENT_NODE=11,DOMNode.NOTATION_NODE=12,DOMNode.NAMESPACE_NODE=13,DOMNode.prototype.hasAttributes=function(){return 0==this.attributes.length?!1:!0},DOMNode.prototype.getNodeName=function(){return this.nodeName},DOMNode.prototype.getNodeValue=function(){return this.nodeValue},DOMNode.prototype.setNodeValue=function(e){if(this.ownerDocument.implementation.errorChecking&&this._readonly)throw new DOMException(DOMException.NO_MODIFICATION_ALLOWED_ERR);this.nodeValue=e},DOMNode.prototype.getNodeType=function(){return this.nodeType},DOMNode.prototype.getParentNode=function(){return this.parentNode},DOMNode.prototype.getChildNodes=function(){return this.childNodes},DOMNode.prototype.getFirstChild=function(){return this.firstChild},DOMNode.prototype.getLastChild=function(){return this.lastChild},DOMNode.prototype.getPreviousSibling=function(){return this.previousSibling},DOMNode.prototype.getNextSibling=function(){return this.nextSibling},DOMNode.prototype.getAttributes=function(){return this.attributes},DOMNode.prototype.getOwnerDocument=function(){return this.ownerDocument},DOMNode.prototype.getNamespaceURI=function(){return this.namespaceURI},DOMNode.prototype.getPrefix=function(){return this.prefix},DOMNode.prototype.setPrefix=function(e){if(this.ownerDocument.implementation.errorChecking){if(this._readonly)throw new DOMException(DOMException.NO_MODIFICATION_ALLOWED_ERR);if(!this.ownerDocument.implementation._isValidName(e))throw new DOMException(DOMException.INVALID_CHARACTER_ERR);if(!this.ownerDocument._isValidNamespace(this.namespaceURI,e+":"+this.localName))throw new DOMException(DOMException.NAMESPACE_ERR);if("xmlns"==e&&"http://www.w3.org/2000/xmlns/"!=this.namespaceURI)throw new DOMException(DOMException.NAMESPACE_ERR);if(""==e&&"xmlns"==this.localName)throw new DOMException(DOMException.NAMESPACE_ERR)}this.prefix=e,""!=this.prefix?this.nodeName=this.prefix+":"+this.localName:this.nodeName=this.localName},DOMNode.prototype.getLocalName=function(){return this.localName},DOMNode.prototype.insertBefore=function(e,t){var n;if(this.ownerDocument.implementation.errorChecking){if(this._readonly)throw new DOMException(DOMException.NO_MODIFICATION_ALLOWED_ERR);if(this.ownerDocument!=e.ownerDocument)throw new DOMException(DOMException.WRONG_DOCUMENT_ERR);if(this._isAncestor(e))throw new DOMException(DOMException.HIERARCHY_REQUEST_ERR)}if(t){var i=this.childNodes._findItemIndex(t._id);if(this.ownerDocument.implementation.errorChecking&&0>i)throw new DOMException(DOMException.NOT_FOUND_ERR);var o=e.parentNode;if(o&&o.removeChild(e),this.childNodes._insertBefore(e,this.childNodes._findItemIndex(t._id)),n=t.previousSibling,e.nodeType==DOMNode.DOCUMENT_FRAGMENT_NODE){if(e.childNodes._nodes.length>0){for(var r=0;r<e.childNodes._nodes.length;r++)e.childNodes._nodes[r].parentNode=this;t.previousSibling=e.childNodes._nodes[e.childNodes._nodes.length-1]}}else e.parentNode=this,t.previousSibling=e}else n=this.lastChild,this.appendChild(e);return e.nodeType==DOMNode.DOCUMENT_FRAGMENT_NODE?e.childNodes._nodes.length>0&&(n?n.nextSibling=e.childNodes._nodes[0]:this.firstChild=e.childNodes._nodes[0],e.childNodes._nodes[0].previousSibling=n,e.childNodes._nodes[e.childNodes._nodes.length-1].nextSibling=t):(n?n.nextSibling=e:this.firstChild=e,e.previousSibling=n,e.nextSibling=t),e},DOMNode.prototype.replaceChild=function(e,t){var n=null;if(this.ownerDocument.implementation.errorChecking){if(this._readonly)throw new DOMException(DOMException.NO_MODIFICATION_ALLOWED_ERR);if(this.ownerDocument!=e.ownerDocument)throw new DOMException(DOMException.WRONG_DOCUMENT_ERR);if(this._isAncestor(e))throw new DOMException(DOMException.HIERARCHY_REQUEST_ERR)}var i=this.childNodes._findItemIndex(t._id);if(this.ownerDocument.implementation.errorChecking&&0>i)throw new DOMException(DOMException.NOT_FOUND_ERR);var o=e.parentNode;if(o&&o.removeChild(e),n=this.childNodes._replaceChild(e,i),e.nodeType==DOMNode.DOCUMENT_FRAGMENT_NODE){if(e.childNodes._nodes.length>0){for(var r=0;r<e.childNodes._nodes.length;r++)e.childNodes._nodes[r].parentNode=this;t.previousSibling?t.previousSibling.nextSibling=e.childNodes._nodes[0]:this.firstChild=e.childNodes._nodes[0],t.nextSibling?t.nextSibling.previousSibling=e:this.lastChild=e.childNodes._nodes[e.childNodes._nodes.length-1],e.childNodes._nodes[0].previousSibling=t.previousSibling,e.childNodes._nodes[e.childNodes._nodes.length-1].nextSibling=t.nextSibling}}else e.parentNode=this,t.previousSibling?t.previousSibling.nextSibling=e:this.firstChild=e,t.nextSibling?t.nextSibling.previousSibling=e:this.lastChild=e,e.previousSibling=t.previousSibling,e.nextSibling=t.nextSibling;return n},DOMNode.prototype.removeChild=function(e){if(this.ownerDocument.implementation.errorChecking&&(this._readonly||e._readonly))throw new DOMException(DOMException.NO_MODIFICATION_ALLOWED_ERR);var t=this.childNodes._findItemIndex(e._id);if(this.ownerDocument.implementation.errorChecking&&0>t)throw new DOMException(DOMException.NOT_FOUND_ERR);return this.childNodes._removeChild(t),e.parentNode=null,e.previousSibling?e.previousSibling.nextSibling=e.nextSibling:this.firstChild=e.nextSibling,e.nextSibling?e.nextSibling.previousSibling=e.previousSibling:this.lastChild=e.previousSibling,e.previousSibling=null,e.nextSibling=null,e},DOMNode.prototype.appendChild=function(e){if(this.ownerDocument.implementation.errorChecking){if(this._readonly)throw new DOMException(DOMException.NO_MODIFICATION_ALLOWED_ERR);if(this.ownerDocument!=e.ownerDocument)throw new DOMException(DOMException.WRONG_DOCUMENT_ERR);if(this._isAncestor(e))throw new DOMException(DOMException.HIERARCHY_REQUEST_ERR)}var t=e.parentNode;if(t&&t.removeChild(e),this.childNodes._appendChild(e),e.nodeType==DOMNode.DOCUMENT_FRAGMENT_NODE){if(e.childNodes._nodes.length>0){for(var n=0;n<e.childNodes._nodes.length;n++)e.childNodes._nodes[n].parentNode=this;this.lastChild?(this.lastChild.nextSibling=e.childNodes._nodes[0],e.childNodes._nodes[0].previousSibling=this.lastChild,this.lastChild=e.childNodes._nodes[e.childNodes._nodes.length-1]):(this.lastChild=e.childNodes._nodes[e.childNodes._nodes.length-1],this.firstChild=e.childNodes._nodes[0])}}else e.parentNode=this,this.lastChild?(this.lastChild.nextSibling=e,e.previousSibling=this.lastChild,this.lastChild=e):(this.lastChild=e,this.firstChild=e);return e},DOMNode.prototype.hasChildNodes=function(){return this.childNodes.length>0},DOMNode.prototype.cloneNode=function(e){try{return this.ownerDocument.importNode(this,e)}catch(t){return null}},DOMNode.prototype.normalize=function(){var e,t=new DOMNodeList;if(this.nodeType==DOMNode.ELEMENT_NODE||this.nodeType==DOMNode.DOCUMENT_NODE){for(var n=null,i=0;i<this.childNodes.length;i++)e=this.childNodes.item(i),e.nodeType==DOMNode.TEXT_NODE?e.length<1?t._appendChild(e):n?(n.appendData(e.data),t._appendChild(e)):n=e:(n=null,e.normalize());for(var i=0;i<t.length;i++)e=t.item(i),e.parentNode.removeChild(e)}},DOMNode.prototype.isSupported=function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},DOMNode.prototype.getElementsByTagName=function(e){return this._getElementsByTagNameRecursive(e,new DOMNodeList(this.ownerDocument))},DOMNode.prototype._getElementsByTagNameRecursive=function(e,t){if(this.nodeType==DOMNode.ELEMENT_NODE||this.nodeType==DOMNode.DOCUMENT_NODE){(this.nodeName==e||"*"==e)&&t._appendChild(this);for(var n=0;n<this.childNodes.length;n++)t=this.childNodes.item(n)._getElementsByTagNameRecursive(e,t)}return t},DOMNode.prototype.getXML=function(){return this.toString()},DOMNode.prototype.getElementsByTagNameNS=function(e,t){return this._getElementsByTagNameNSRecursive(e,t,new DOMNodeList(this.ownerDocument))},DOMNode.prototype._getElementsByTagNameNSRecursive=function(e,t,n){if(this.nodeType==DOMNode.ELEMENT_NODE||this.nodeType==DOMNode.DOCUMENT_NODE){this.namespaceURI!=e&&"*"!=e||this.localName!=t&&"*"!=t||n._appendChild(this);for(var i=0;i<this.childNodes.length;i++)n=this.childNodes.item(i)._getElementsByTagNameNSRecursive(e,t,n)}return n},DOMNode.prototype._isAncestor=function(e){return this==e||this.parentNode&&this.parentNode._isAncestor(e)},DOMNode.prototype.importNode=function(e,t){var n;this.getOwnerDocument()._performingImportNodeOperation=!0;try{if(e.nodeType==DOMNode.ELEMENT_NODE)if(this.ownerDocument.implementation.namespaceAware){n=this.ownerDocument.createElementNS(e.namespaceURI,e.nodeName);for(var i=0;i<e.attributes.length;i++)n.setAttributeNS(e.attributes.item(i).namespaceURI,e.attributes.item(i).name,e.attributes.item(i).value);for(var i=0;i<e._namespaces.length;i++)n._namespaces._nodes[i]=this.ownerDocument.createNamespace(e._namespaces.item(i).localName),n._namespaces._nodes[i].setValue(e._namespaces.item(i).value)}else{n=this.ownerDocument.createElement(e.tagName);for(var i=0;i<e.attributes.length;i++)n.setAttribute(e.attributes.item(i).name,e.attributes.item(i).value)}else if(e.nodeType==DOMNode.ATTRIBUTE_NODE){if(this.ownerDocument.implementation.namespaceAware){n=this.ownerDocument.createAttributeNS(e.namespaceURI,e.nodeName);for(var i=0;i<e._namespaces.length;i++)n._namespaces._nodes[i]=this.ownerDocument.createNamespace(e._namespaces.item(i).localName),n._namespaces._nodes[i].setValue(e._namespaces.item(i).value)}else n=this.ownerDocument.createAttribute(e.name);n.setValue(e.value)}else if(e.nodeType==DOMNode.DOCUMENT_FRAGMENT)n=this.ownerDocument.createDocumentFragment();else if(e.nodeType==DOMNode.NAMESPACE_NODE)n=this.ownerDocument.createNamespace(e.nodeName),n.setValue(e.value);else if(e.nodeType==DOMNode.TEXT_NODE)n=this.ownerDocument.createTextNode(e.data);else if(e.nodeType==DOMNode.CDATA_SECTION_NODE)n=this.ownerDocument.createCDATASection(e.data);else if(e.nodeType==DOMNode.PROCESSING_INSTRUCTION_NODE)n=this.ownerDocument.createProcessingInstruction(e.target,e.data);else{if(e.nodeType!=DOMNode.COMMENT_NODE)throw new DOMException(DOMException.NOT_SUPPORTED_ERR);n=this.ownerDocument.createComment(e.data)}if(t)for(var i=0;i<e.childNodes.length;i++)n.appendChild(this.ownerDocument.importNode(e.childNodes.item(i),!0));return this.getOwnerDocument()._performingImportNodeOperation=!1,n}catch(o){throw this.getOwnerDocument()._performingImportNodeOperation=!1,o}},DOMNode.prototype.__escapeString=function(e){return __escapeString(e)},DOMNode.prototype.__unescapeString=function(e){return __unescapeString(e)},DOMDocument=function(e){this._class=addClass(this._class,"DOMDocument"),this.DOMNode=DOMNode,this.DOMNode(this),this.doctype=null,this.implementation=e,this.documentElement=null,this.all=new Array,this.nodeName="#document",this.nodeType=DOMNode.DOCUMENT_NODE,this._id=0,this._lastId=0,this._parseComplete=!1,this.ownerDocument=this,this._performingImportNodeOperation=!1},DOMDocument.prototype=new DOMNode,DOMDocument.prototype.getDoctype=function(){return this.doctype},DOMDocument.prototype.getImplementation=function(){return this.implementation},DOMDocument.prototype.getDocumentElement=function(){return this.documentElement},DOMDocument.prototype.createElement=function(e){if(this.ownerDocument.implementation.errorChecking&&!this.ownerDocument.implementation._isValidName(e))throw new DOMException(DOMException.INVALID_CHARACTER_ERR);var t=new DOMElement(this);return t.tagName=e,t.nodeName=e,this.all[this.all.length]=t,t},DOMDocument.prototype.createDocumentFragment=function(){var e=new DOMDocumentFragment(this);return e},DOMDocument.prototype.createTextNode=function(e){var t=new DOMText(this);return t.data=e,t.nodeValue=e,t.length=e.length,t},DOMDocument.prototype.createComment=function(e){var t=new DOMComment(this);return t.data=e,t.nodeValue=e,t.length=e.length,t},DOMDocument.prototype.createCDATASection=function(e){var t=new DOMCDATASection(this);return t.data=e,t.nodeValue=e,t.length=e.length,t},DOMDocument.prototype.createProcessingInstruction=function(e,t){if(this.ownerDocument.implementation.errorChecking&&!this.implementation._isValidName(e))throw new DOMException(DOMException.INVALID_CHARACTER_ERR);var n=new DOMProcessingInstruction(this);return n.target=e,n.nodeName=e,n.data=t,n.nodeValue=t,n.length=t.length,n},DOMDocument.prototype.createAttribute=function(e){if(this.ownerDocument.implementation.errorChecking&&!this.ownerDocument.implementation._isValidName(e))throw new DOMException(DOMException.INVALID_CHARACTER_ERR);var t=new DOMAttr(this);return t.name=e,t.nodeName=e,t},DOMDocument.prototype.createElementNS=function(e,t){if(this.ownerDocument.implementation.errorChecking){if(!this.ownerDocument._isValidNamespace(e,t))throw new DOMException(DOMException.NAMESPACE_ERR);if(!this.ownerDocument.implementation._isValidName(t))throw new DOMException(DOMException.INVALID_CHARACTER_ERR)}var n=new DOMElement(this),i=this.implementation._parseQName(t);return n.nodeName=t,n.namespaceURI=e,n.prefix=i.prefix,n.localName=i.localName,n.tagName=t,this.all[this.all.length]=n,n},DOMDocument.prototype.createAttributeNS=function(e,t){if(this.ownerDocument.implementation.errorChecking){if(!this.ownerDocument._isValidNamespace(e,t,!0))throw new DOMException(DOMException.NAMESPACE_ERR);if(!this.ownerDocument.implementation._isValidName(t))throw new DOMException(DOMException.INVALID_CHARACTER_ERR)}var n=new DOMAttr(this),i=this.implementation._parseQName(t);return n.nodeName=t,n.namespaceURI=e,n.prefix=i.prefix,n.localName=i.localName,n.name=t,n.nodeValue="",n},DOMDocument.prototype.createNamespace=function(e){var t=new DOMNamespace(this),n=this.implementation._parseQName(e);return t.nodeName=e,t.prefix=n.prefix,t.localName=n.localName,t.name=e,t.nodeValue="",t},DOMDocument.prototype.getElementById=function(e){retNode=null;for(var t=0;t<this.all.length;t++){var n=this.all[t];if(n.id==e&&n._isAncestor(n.ownerDocument.documentElement)){retNode=n;break}}return retNode},DOMDocument.prototype._genId=function(){return this._lastId+=1,this._lastId},DOMDocument.prototype._isValidNamespace=function(e,t,n){if(1==this._performingImportNodeOperation)return!0;var i=!0,o=this.implementation._parseQName(t);return 1==this._parseComplete&&(o.localName.indexOf(":")>-1&&(i=!1),i&&!n&&(e||(i=!1)),i&&""==o.prefix&&(i=!1)),i&&"xml"==o.prefix&&"http://www.w3.org/XML/1998/namespace"!=e&&(i=!1),i},DOMDocument.prototype.toString=function(){return""+this.childNodes},DOMElement=function(e){this._class=addClass(this._class,"DOMElement"),this.DOMNode=DOMNode,this.DOMNode(e),this.tagName="",this.id="",this.nodeType=DOMNode.ELEMENT_NODE},DOMElement.prototype=new DOMNode,DOMElement.prototype.getTagName=function(){return this.tagName},DOMElement.prototype.getAttribute=function(e){var t="",n=this.attributes.getNamedItem(e);return n&&(t=n.value),t},DOMElement.prototype.setAttribute=function(e,t){var n=this.attributes.getNamedItem(e);n||(n=this.ownerDocument.createAttribute(e));var t=new String(t);if(this.ownerDocument.implementation.errorChecking){if(n._readonly)throw new DOMException(DOMException.NO_MODIFICATION_ALLOWED_ERR);if(!this.ownerDocument.implementation._isValidString(t))throw new DOMException(DOMException.INVALID_CHARACTER_ERR)}this.ownerDocument.implementation._isIdDeclaration(e)&&(this.id=t),n.value=t,n.nodeValue=t,t.length>0?n.specified=!0:n.specified=!1,this.attributes.setNamedItem(n)},DOMElement.prototype.removeAttribute=function(e){return this.attributes.removeNamedItem(e)},DOMElement.prototype.getAttributeNode=function(e){return this.attributes.getNamedItem(e)},DOMElement.prototype.setAttributeNode=function(e){return this.ownerDocument.implementation._isIdDeclaration(e.name)&&(this.id=e.value),this.attributes.setNamedItem(e)},DOMElement.prototype.removeAttributeNode=function(e){if(this.ownerDocument.implementation.errorChecking&&e._readonly)throw new DOMException(DOMException.NO_MODIFICATION_ALLOWED_ERR);var t=this.attributes._findItemIndex(e._id);if(this.ownerDocument.implementation.errorChecking&&0>t)throw new DOMException(DOMException.NOT_FOUND_ERR);return this.attributes._removeChild(t)},DOMElement.prototype.getAttributeNS=function(e,t){
var n="",i=this.attributes.getNamedItemNS(e,t);return i&&(n=i.value),n},DOMElement.prototype.setAttributeNS=function(e,t,n){var i=this.attributes.getNamedItem(e,t);i||(i=this.ownerDocument.createAttributeNS(e,t));var n=new String(n);if(this.ownerDocument.implementation.errorChecking){if(i._readonly)throw new DOMException(DOMException.NO_MODIFICATION_ALLOWED_ERR);if(!this.ownerDocument._isValidNamespace(e,t))throw new DOMException(DOMException.NAMESPACE_ERR);if(!this.ownerDocument.implementation._isValidString(n))throw new DOMException(DOMException.INVALID_CHARACTER_ERR)}this.ownerDocument.implementation._isIdDeclaration(name)&&(this.id=n),i.value=n,i.nodeValue=n,n.length>0?i.specified=!0:i.specified=!1,this.attributes.setNamedItemNS(i)},DOMElement.prototype.removeAttributeNS=function(e,t){return this.attributes.removeNamedItemNS(e,t)},DOMElement.prototype.getAttributeNodeNS=function(e,t){return this.attributes.getNamedItemNS(e,t)},DOMElement.prototype.setAttributeNodeNS=function(e){return""==e.prefix&&this.ownerDocument.implementation._isIdDeclaration(e.name)&&(this.id=e.value),this.attributes.setNamedItemNS(e)},DOMElement.prototype.hasAttribute=function(e){return this.attributes._hasAttribute(e)},DOMElement.prototype.hasAttributeNS=function(e,t){return this.attributes._hasAttributeNS(e,t)},DOMElement.prototype.toString=function(){var e="",t=this._namespaces.toString();t.length>0&&(t=" "+t);var n=this.attributes.toString();return n.length>0&&(n=" "+n),e+="<"+this.nodeName+t+n+">",e+=this.childNodes.toString(),e+="</"+this.nodeName+">"},DOMAttr=function(e){this._class=addClass(this._class,"DOMAttr"),this.DOMNode=DOMNode,this.DOMNode(e),this.name="",this.specified=!1,this.value="",this.nodeType=DOMNode.ATTRIBUTE_NODE,this.ownerElement=null,this.childNodes=null,this.attributes=null},DOMAttr.prototype=new DOMNode,DOMAttr.prototype.getName=function(){return this.nodeName},DOMAttr.prototype.getSpecified=function(){return this.specified},DOMAttr.prototype.getValue=function(){return this.nodeValue},DOMAttr.prototype.setValue=function(e){if(this.ownerDocument.implementation.errorChecking&&this._readonly)throw new DOMException(DOMException.NO_MODIFICATION_ALLOWED_ERR);this.setNodeValue(e)},DOMAttr.prototype.setNodeValue=function(e){this.nodeValue=new String(e),this.value=this.nodeValue,this.specified=this.value.length>0},DOMAttr.prototype.toString=function(){var e="";return e+=this.nodeName+'="'+this.__escapeString(this.nodeValue)+'"'},DOMAttr.prototype.getOwnerElement=function(){return this.ownerElement},DOMNamespace=function(e){this._class=addClass(this._class,"DOMNamespace"),this.DOMNode=DOMNode,this.DOMNode(e),this.name="",this.specified=!1,this.value="",this.nodeType=DOMNode.NAMESPACE_NODE},DOMNamespace.prototype=new DOMNode,DOMNamespace.prototype.getValue=function(){return this.nodeValue},DOMNamespace.prototype.setValue=function(e){this.nodeValue=new String(e),this.value=this.nodeValue},DOMNamespace.prototype.toString=function(){var e="";return e+=""!=this.nodeName?this.nodeName+'="'+this.__escapeString(this.nodeValue)+'"':'xmlns="'+this.__escapeString(this.nodeValue)+'"'},DOMCharacterData=function(e){this._class=addClass(this._class,"DOMCharacterData"),this.DOMNode=DOMNode,this.DOMNode(e),this.data="",this.length=0},DOMCharacterData.prototype=new DOMNode,DOMCharacterData.prototype.getData=function(){return this.nodeValue},DOMCharacterData.prototype.setData=function(e){this.setNodeValue(e)},DOMCharacterData.prototype.setNodeValue=function(e){if(this.ownerDocument.implementation.errorChecking&&this._readonly)throw new DOMException(DOMException.NO_MODIFICATION_ALLOWED_ERR);this.nodeValue=new String(e),this.data=this.nodeValue,this.length=this.nodeValue.length},DOMCharacterData.prototype.getLength=function(){return this.nodeValue.length},DOMCharacterData.prototype.substringData=function(e,t){var n=null;if(this.data){if(this.ownerDocument.implementation.errorChecking&&(0>e||e>this.data.length||0>t))throw new DOMException(DOMException.INDEX_SIZE_ERR);n=t?this.data.substring(e,e+t):this.data.substring(e)}return n},DOMCharacterData.prototype.appendData=function(e){if(this.ownerDocument.implementation.errorChecking&&this._readonly)throw new DOMException(DOMException.NO_MODIFICATION_ALLOWED_ERR);this.setData(""+this.data+e)},DOMCharacterData.prototype.insertData=function(e,t){if(this.ownerDocument.implementation.errorChecking&&this._readonly)throw new DOMException(DOMException.NO_MODIFICATION_ALLOWED_ERR);if(this.data){if(this.ownerDocument.implementation.errorChecking&&(0>e||e>this.data.length))throw new DOMException(DOMException.INDEX_SIZE_ERR);this.setData(this.data.substring(0,e).concat(t,this.data.substring(e)))}else{if(this.ownerDocument.implementation.errorChecking&&0!=e)throw new DOMException(DOMException.INDEX_SIZE_ERR);this.setData(t)}},DOMCharacterData.prototype.deleteData=function(e,t){if(this.ownerDocument.implementation.errorChecking&&this._readonly)throw new DOMException(DOMException.NO_MODIFICATION_ALLOWED_ERR);if(this.data){if(this.ownerDocument.implementation.errorChecking&&(0>e||e>this.data.length||0>t))throw new DOMException(DOMException.INDEX_SIZE_ERR);!t||e+t>this.data.length?this.setData(this.data.substring(0,e)):this.setData(this.data.substring(0,e).concat(this.data.substring(e+t)))}},DOMCharacterData.prototype.replaceData=function(e,t,n){if(this.ownerDocument.implementation.errorChecking&&this._readonly)throw new DOMException(DOMException.NO_MODIFICATION_ALLOWED_ERR);if(this.data){if(this.ownerDocument.implementation.errorChecking&&(0>e||e>this.data.length||0>t))throw new DOMException(DOMException.INDEX_SIZE_ERR);this.setData(this.data.substring(0,e).concat(n,this.data.substring(e+t)))}else this.setData(n)},DOMText=function(e){this._class=addClass(this._class,"DOMText"),this.DOMCharacterData=DOMCharacterData,this.DOMCharacterData(e),this.nodeName="#text",this.nodeType=DOMNode.TEXT_NODE},DOMText.prototype=new DOMCharacterData,DOMText.prototype.splitText=function(e){var t,n;if(this.ownerDocument.implementation.errorChecking){if(this._readonly)throw new DOMException(DOMException.NO_MODIFICATION_ALLOWED_ERR);if(0>e||e>this.data.length)throw new DOMException(DOMException.INDEX_SIZE_ERR)}return this.parentNode&&(t=this.substringData(e),n=this.ownerDocument.createTextNode(t),this.nextSibling?this.parentNode.insertBefore(n,this.nextSibling):this.parentNode.appendChild(n),this.deleteData(e)),n},DOMText.prototype.toString=function(){return this.__escapeString(""+this.nodeValue)},DOMCDATASection=function(e){this._class=addClass(this._class,"DOMCDATASection"),this.DOMCharacterData=DOMCharacterData,this.DOMCharacterData(e),this.nodeName="#cdata-section",this.nodeType=DOMNode.CDATA_SECTION_NODE},DOMCDATASection.prototype=new DOMCharacterData,DOMCDATASection.prototype.splitText=function(e){var t,n;if(this.ownerDocument.implementation.errorChecking){if(this._readonly)throw new DOMException(DOMException.NO_MODIFICATION_ALLOWED_ERR);if(0>e||e>this.data.length)throw new DOMException(DOMException.INDEX_SIZE_ERR)}return this.parentNode&&(t=this.substringData(e),n=this.ownerDocument.createCDATASection(t),this.nextSibling?this.parentNode.insertBefore(n,this.nextSibling):this.parentNode.appendChild(n),this.deleteData(e)),n},DOMCDATASection.prototype.toString=function(){var e="";return e+="<![CDATA["+this.nodeValue+"]]>"},DOMComment=function(e){this._class=addClass(this._class,"DOMComment"),this.DOMCharacterData=DOMCharacterData,this.DOMCharacterData(e),this.nodeName="#comment",this.nodeType=DOMNode.COMMENT_NODE},DOMComment.prototype=new DOMCharacterData,DOMComment.prototype.toString=function(){var e="";return e+="<!--"+this.nodeValue+"-->"},DOMProcessingInstruction=function(e){this._class=addClass(this._class,"DOMProcessingInstruction"),this.DOMNode=DOMNode,this.DOMNode(e),this.target="",this.data="",this.nodeType=DOMNode.PROCESSING_INSTRUCTION_NODE},DOMProcessingInstruction.prototype=new DOMNode,DOMProcessingInstruction.prototype.getTarget=function(){return this.nodeName},DOMProcessingInstruction.prototype.getData=function(){return this.nodeValue},DOMProcessingInstruction.prototype.setData=function(e){this.setNodeValue(e)},DOMProcessingInstruction.prototype.setNodeValue=function(e){if(this.ownerDocument.implementation.errorChecking&&this._readonly)throw new DOMException(DOMException.NO_MODIFICATION_ALLOWED_ERR);this.nodeValue=new String(e),this.data=this.nodeValue},DOMProcessingInstruction.prototype.toString=function(){var e="";return e+="<?"+this.nodeName+" "+this.nodeValue+" ?>"},DOMDocumentFragment=function(e){this._class=addClass(this._class,"DOMDocumentFragment"),this.DOMNode=DOMNode,this.DOMNode(e),this.nodeName="#document-fragment",this.nodeType=DOMNode.DOCUMENT_FRAGMENT_NODE},DOMDocumentFragment.prototype=new DOMNode,DOMDocumentFragment.prototype.toString=function(){var e="",t=this.getChildNodes().getLength();for(intLoop=0;intLoop<t;intLoop++)e+=this.getChildNodes().item(intLoop).toString();return e},DOMDocumentType=function(){alert("DOMDocumentType.constructor(): Not Implemented")},DOMEntity=function(){alert("DOMEntity.constructor(): Not Implemented")},DOMEntityReference=function(){alert("DOMEntityReference.constructor(): Not Implemented")},DOMNotation=function(){alert("DOMNotation.constructor(): Not Implemented")},Strings=new Object,Strings.WHITESPACE=" 	\n\r",Strings.QUOTES="\"'",Strings.isEmpty=function(e){return null==e||0==e.length},Strings.indexOfNonWhitespace=function(e,t,n){if(Strings.isEmpty(e))return-1;t=t||0,n=n||e.length;for(var i=t;n>i;i++)if(-1==Strings.WHITESPACE.indexOf(e.charAt(i)))return i;return-1},Strings.lastIndexOfNonWhitespace=function(e,t,n){if(Strings.isEmpty(e))return-1;t=t||0,n=n||e.length;for(var i=n-1;i>=t;i--)if(-1==Strings.WHITESPACE.indexOf(e.charAt(i)))return i;return-1},Strings.indexOfWhitespace=function(e,t,n){if(Strings.isEmpty(e))return-1;t=t||0,n=n||e.length;for(var i=t;n>i;i++)if(-1!=Strings.WHITESPACE.indexOf(e.charAt(i)))return i;return-1},Strings.replace=function(e,t,n,i,o){return Strings.isEmpty(e)?"":(t=t||0,n=n||e.length,e.substring(t,n).split(i).join(o))},Strings.getLineNumber=function(e,t){return Strings.isEmpty(e)?-1:(t=t||e.length,e.substring(0,t).split("\n").length)},Strings.getColumnNumber=function(e,t){if(Strings.isEmpty(e))return-1;t=t||e.length;var n=e.substring(0,t).split("\n");n[n.length-1];n.length--;var i=n.join("\n").length;return t-i},StringBuffer=function(){this._a=new Array},StringBuffer.prototype.append=function(e){this._a[this._a.length]=e},StringBuffer.prototype.toString=function(){return this._a.join("")};

//xml sax
function isEmpty(t){return null==t||0==t.length}function trim(t,e,r){if(isEmpty(t))return"";null==e&&(e=!0),null==r&&(r=!0);var i=0,n=0,s=0,_=0;if(1==e)for(;s<t.length&&-1!=whitespace.indexOf(t.charAt(s++));)i++;if(1==r)for(_=t.length-1;_>=i&&-1!=whitespace.indexOf(t.charAt(_--));)n++;return t.substring(i,t.length-n)}function __escapeString(t){var e=/&/g,r=/</g,i=/>/g,n=/"/g,s=/'/g;return t=t.replace(e,"&amp;"),t=t.replace(r,"&lt;"),t=t.replace(i,"&gt;"),t=t.replace(n,"&quot;"),t=t.replace(s,"&apos;")}function __unescapeString(t){var e=/&amp;/g,r=/&lt;/g,i=/&gt;/g,n=/&quot;/g,s=/&apos;/g;return t=t.replace(e,"&"),t=t.replace(r,"<"),t=t.replace(i,">"),t=t.replace(n,'"'),t=t.replace(s,"'")}var whitespace="\n\r	 ";XMLP=function(t){t=SAXStrings.replace(t,null,null,"\r\n","\n"),t=SAXStrings.replace(t,null,null,"\r","\n"),this.m_xml=t,this.m_iP=0,this.m_iState=XMLP._STATE_PROLOG,this.m_stack=new Stack,this._clearAttributes()},XMLP._NONE=0,XMLP._ELM_B=1,XMLP._ELM_E=2,XMLP._ELM_EMP=3,XMLP._ATT=4,XMLP._TEXT=5,XMLP._ENTITY=6,XMLP._PI=7,XMLP._CDATA=8,XMLP._COMMENT=9,XMLP._DTD=10,XMLP._ERROR=11,XMLP._CONT_XML=0,XMLP._CONT_ALT=1,XMLP._ATT_NAME=0,XMLP._ATT_VAL=1,XMLP._STATE_PROLOG=1,XMLP._STATE_DOCUMENT=2,XMLP._STATE_MISC=3,XMLP._errs=new Array,XMLP._errs[XMLP.ERR_CLOSE_PI=0]="PI: missing closing sequence",XMLP._errs[XMLP.ERR_CLOSE_DTD=1]="DTD: missing closing sequence",XMLP._errs[XMLP.ERR_CLOSE_COMMENT=2]="Comment: missing closing sequence",XMLP._errs[XMLP.ERR_CLOSE_CDATA=3]="CDATA: missing closing sequence",XMLP._errs[XMLP.ERR_CLOSE_ELM=4]="Element: missing closing sequence",XMLP._errs[XMLP.ERR_CLOSE_ENTITY=5]="Entity: missing closing sequence",XMLP._errs[XMLP.ERR_PI_TARGET=6]="PI: target is required",XMLP._errs[XMLP.ERR_ELM_EMPTY=7]="Element: cannot be both empty and closing",XMLP._errs[XMLP.ERR_ELM_NAME=8]='Element: name must immediatly follow "<"',XMLP._errs[XMLP.ERR_ELM_LT_NAME=9]='Element: "<" not allowed in element names',XMLP._errs[XMLP.ERR_ATT_VALUES=10]="Attribute: values are required and must be in quotes",XMLP._errs[XMLP.ERR_ATT_LT_NAME=11]='Element: "<" not allowed in attribute names',XMLP._errs[XMLP.ERR_ATT_LT_VALUE=12]='Attribute: "<" not allowed in attribute values',XMLP._errs[XMLP.ERR_ATT_DUP=13]="Attribute: duplicate attributes not allowed",XMLP._errs[XMLP.ERR_ENTITY_UNKNOWN=14]="Entity: unknown entity",XMLP._errs[XMLP.ERR_INFINITELOOP=15]="Infininte loop",XMLP._errs[XMLP.ERR_DOC_STRUCTURE=16]="Document: only comments, processing instructions, or whitespace allowed outside of document element",XMLP._errs[XMLP.ERR_ELM_NESTING=17]="Element: must be nested correctly",XMLP.prototype._addAttribute=function(t,e){this.m_atts[this.m_atts.length]=new Array(t,e)},XMLP.prototype._checkStructure=function(t){if(XMLP._STATE_PROLOG==this.m_iState){if((XMLP._TEXT==t||XMLP._ENTITY==t)&&-1!=SAXStrings.indexOfNonWhitespace(this.getContent(),this.getContentBegin(),this.getContentEnd()))return this._setErr(XMLP.ERR_DOC_STRUCTURE);(XMLP._ELM_B==t||XMLP._ELM_EMP==t)&&(this.m_iState=XMLP._STATE_DOCUMENT)}if(XMLP._STATE_DOCUMENT==this.m_iState){if((XMLP._ELM_B==t||XMLP._ELM_EMP==t)&&this.m_stack.push(this.getName()),XMLP._ELM_E==t||XMLP._ELM_EMP==t){var e=this.m_stack.pop();if(null==e||e!=this.getName())return this._setErr(XMLP.ERR_ELM_NESTING)}if(0==this.m_stack.count())return this.m_iState=XMLP._STATE_MISC,t}if(XMLP._STATE_MISC==this.m_iState){if(XMLP._ELM_B==t||XMLP._ELM_E==t||XMLP._ELM_EMP==t||XMLP.EVT_DTD==t)return this._setErr(XMLP.ERR_DOC_STRUCTURE);if((XMLP._TEXT==t||XMLP._ENTITY==t)&&-1!=SAXStrings.indexOfNonWhitespace(this.getContent(),this.getContentBegin(),this.getContentEnd()))return this._setErr(XMLP.ERR_DOC_STRUCTURE)}return t},XMLP.prototype._clearAttributes=function(){this.m_atts=new Array},XMLP.prototype._findAttributeIndex=function(t){for(var e=0;e<this.m_atts.length;e++)if(this.m_atts[e][XMLP._ATT_NAME]==t)return e;return-1},XMLP.prototype.getAttributeCount=function(){return this.m_atts?this.m_atts.length:0},XMLP.prototype.getAttributeName=function(t){return 0>t||t>=this.m_atts.length?null:this.m_atts[t][XMLP._ATT_NAME]},XMLP.prototype.getAttributeValue=function(t){return 0>t||t>=this.m_atts.length?null:__unescapeString(this.m_atts[t][XMLP._ATT_VAL])},XMLP.prototype.getAttributeValueByName=function(t){return this.getAttributeValue(this._findAttributeIndex(t))},XMLP.prototype.getColumnNumber=function(){return SAXStrings.getColumnNumber(this.m_xml,this.m_iP)},XMLP.prototype.getContent=function(){return this.m_cSrc==XMLP._CONT_XML?this.m_xml:this.m_cAlt},XMLP.prototype.getContentBegin=function(){return this.m_cB},XMLP.prototype.getContentEnd=function(){return this.m_cE},XMLP.prototype.getLineNumber=function(){return SAXStrings.getLineNumber(this.m_xml,this.m_iP)},XMLP.prototype.getName=function(){return this.m_name},XMLP.prototype.next=function(){return this._checkStructure(this._parse())},XMLP.prototype._parse=function(){return this.m_iP==this.m_xml.length?XMLP._NONE:this.m_iP==this.m_xml.indexOf("<?",this.m_iP)?this._parsePI(this.m_iP+2):this.m_iP==this.m_xml.indexOf("<!DOCTYPE",this.m_iP)?this._parseDTD(this.m_iP+9):this.m_iP==this.m_xml.indexOf("<!--",this.m_iP)?this._parseComment(this.m_iP+4):this.m_iP==this.m_xml.indexOf("<![CDATA[",this.m_iP)?this._parseCDATA(this.m_iP+9):this.m_iP==this.m_xml.indexOf("<",this.m_iP)?this._parseElement(this.m_iP+1):this.m_iP==this.m_xml.indexOf("&",this.m_iP)?this._parseEntity(this.m_iP+1):this._parseText(this.m_iP)},XMLP.prototype._parseAttribute=function(t,e){var r,i,n,s,_,h,o,m;return this.m_cAlt="",r=SAXStrings.indexOfNonWhitespace(this.m_xml,t,e),-1==r||r>=e?r:(n=this.m_xml.indexOf("=",r),-1==n||n>e?this._setErr(XMLP.ERR_ATT_VALUES):(i=SAXStrings.lastIndexOfNonWhitespace(this.m_xml,r,n),s=SAXStrings.indexOfNonWhitespace(this.m_xml,n+1,e),-1==s||s>e?this._setErr(XMLP.ERR_ATT_VALUES):(h=this.m_xml.charAt(s),-1==SAXStrings.QUOTES.indexOf(h)?this._setErr(XMLP.ERR_ATT_VALUES):(_=this.m_xml.indexOf(h,s+1),-1==_||_>e?this._setErr(XMLP.ERR_ATT_VALUES):(o=this.m_xml.substring(r,i+1),m=this.m_xml.substring(s+1,_),-1!=o.indexOf("<")?this._setErr(XMLP.ERR_ATT_LT_NAME):-1!=m.indexOf("<")?this._setErr(XMLP.ERR_ATT_LT_VALUE):(m=SAXStrings.replace(m,null,null,"\n"," "),m=SAXStrings.replace(m,null,null,"	"," "),iRet=this._replaceEntities(m),iRet==XMLP._ERROR?iRet:(m=this.m_cAlt,-1!=this._findAttributeIndex(o)?this._setErr(XMLP.ERR_ATT_DUP):(this._addAttribute(o,m),this.m_iP=_+2,XMLP._ATT))))))))},XMLP.prototype._parseCDATA=function(t){var e=this.m_xml.indexOf("]]>",t);return-1==e?this._setErr(XMLP.ERR_CLOSE_CDATA):(this._setContent(XMLP._CONT_XML,t,e),this.m_iP=e+3,XMLP._CDATA)},XMLP.prototype._parseComment=function(t){var e=this.m_xml.indexOf("-->",t);return-1==e?this._setErr(XMLP.ERR_CLOSE_COMMENT):(this._setContent(XMLP._CONT_XML,t,e),this.m_iP=e+3,XMLP._COMMENT)},XMLP.prototype._parseDTD=function(t){var e,r,i,n;if(e=this.m_xml.indexOf(">",t),-1==e)return this._setErr(XMLP.ERR_CLOSE_DTD);for(i=this.m_xml.indexOf("[",t),r=-1!=i&&e>i?"]>":">";;){if(e==n)return this._setErr(XMLP.ERR_INFINITELOOP);if(n=e,e=this.m_xml.indexOf(r,t),-1==e)return this._setErr(XMLP.ERR_CLOSE_DTD);if("]]>"!=this.m_xml.substring(e-1,e+2))break}return this.m_iP=e+r.length,XMLP._DTD},XMLP.prototype._parseElement=function(t){var e,r,i,n,s,_,h;if(r=e=this.m_xml.indexOf(">",t),-1==e)return this._setErr(XMLP.ERR_CLOSE_ELM);if("/"==this.m_xml.charAt(t)?(s=XMLP._ELM_E,t++):s=XMLP._ELM_B,"/"==this.m_xml.charAt(e-1)){if(s==XMLP._ELM_E)return this._setErr(XMLP.ERR_ELM_EMPTY);s=XMLP._ELM_EMP,r--}if(r=SAXStrings.lastIndexOfNonWhitespace(this.m_xml,t,r),e-t!=1&&SAXStrings.indexOfNonWhitespace(this.m_xml,t,r)!=t)return this._setErr(XMLP.ERR_ELM_NAME);if(this._clearAttributes(),i=SAXStrings.indexOfWhitespace(this.m_xml,t,r),-1==i)i=r+1;else for(this.m_iP=i;this.m_iP<r;){if(this.m_iP==h)return this._setErr(XMLP.ERR_INFINITELOOP);if(h=this.m_iP,n=this._parseAttribute(this.m_iP,r),n==XMLP._ERROR)return n}return _=this.m_xml.substring(t,i),-1!=_.indexOf("<")?this._setErr(XMLP.ERR_ELM_LT_NAME):(this.m_name=_,this.m_iP=e+1,s)},XMLP.prototype._parseEntity=function(t){var e=this.m_xml.indexOf(";",t);return-1==e?this._setErr(XMLP.ERR_CLOSE_ENTITY):(this.m_iP=e+1,this._replaceEntity(this.m_xml,t,e))},XMLP.prototype._parsePI=function(t){var e,r,i,n,s;return e=this.m_xml.indexOf("?>",t),-1==e?this._setErr(XMLP.ERR_CLOSE_PI):(r=SAXStrings.indexOfNonWhitespace(this.m_xml,t,e),-1==r?this._setErr(XMLP.ERR_PI_TARGET):(i=SAXStrings.indexOfWhitespace(this.m_xml,r,e),-1==i&&(i=e),n=SAXStrings.indexOfNonWhitespace(this.m_xml,i,e),-1==n&&(n=e),s=SAXStrings.lastIndexOfNonWhitespace(this.m_xml,n,e),-1==s&&(s=e-1),this.m_name=this.m_xml.substring(r,i),this._setContent(XMLP._CONT_XML,n,s+1),this.m_iP=e+2,XMLP._PI))},XMLP.prototype._parseText=function(t){var e,r;return e=this.m_xml.indexOf("<",t),-1==e&&(e=this.m_xml.length),r=this.m_xml.indexOf("&",t),-1!=r&&e>=r&&(e=r),this._setContent(XMLP._CONT_XML,t,e),this.m_iP=e,XMLP._TEXT},XMLP.prototype._replaceEntities=function(t,e,r){if(SAXStrings.isEmpty(t))return"";e=e||0,r=r||t.length;var i,n,s="";for(i=t.indexOf("&",e),n=e;i>0&&r>i;){if(s+=t.substring(n,i),n=t.indexOf(";",i)+1,0==n||n>r)return this._setErr(XMLP.ERR_CLOSE_ENTITY);if(iRet=this._replaceEntity(t,i+1,n-1),iRet==XMLP._ERROR)return iRet;s+=this.m_cAlt,i=t.indexOf("&",n)}return n!=r&&(s+=t.substring(n,r)),this._setContent(XMLP._CONT_ALT,s),XMLP._ENTITY},XMLP.prototype._replaceEntity=function(t,e,r){if(SAXStrings.isEmpty(t))return-1;switch(e=e||0,r=r||t.length,t.substring(e,r)){case"amp":strEnt="&";break;case"lt":strEnt="<";break;case"gt":strEnt=">";break;case"apos":strEnt="'";break;case"quot":strEnt='"';break;default:if("#"!=t.charAt(e))return this._setErr(XMLP.ERR_ENTITY_UNKNOWN);strEnt=String.fromCharCode(parseInt(t.substring(e+1,r)))}return this._setContent(XMLP._CONT_ALT,strEnt),XMLP._ENTITY},XMLP.prototype._setContent=function(t){var e=arguments;XMLP._CONT_XML==t?(this.m_cAlt=null,this.m_cB=e[1],this.m_cE=e[2]):(this.m_cAlt=e[1],this.m_cB=0,this.m_cE=e[1].length),this.m_cSrc=t},XMLP.prototype._setErr=function(t){var e=XMLP._errs[t];return this.m_cAlt=e,this.m_cB=0,this.m_cE=e.length,this.m_cSrc=XMLP._CONT_ALT,XMLP._ERROR},SAXDriver=function(){this.m_hndDoc=null,this.m_hndErr=null,this.m_hndLex=null},SAXDriver.DOC_B=1,SAXDriver.DOC_E=2,SAXDriver.ELM_B=3,SAXDriver.ELM_E=4,SAXDriver.CHARS=5,SAXDriver.PI=6,SAXDriver.CD_B=7,SAXDriver.CD_E=8,SAXDriver.CMNT=9,SAXDriver.DTD_B=10,SAXDriver.DTD_E=11,SAXDriver.prototype.parse=function(t){var e=new XMLP(t);this.m_hndDoc&&this.m_hndDoc.setDocumentLocator&&this.m_hndDoc.setDocumentLocator(this),this.m_parser=e,this.m_bErr=!1,this.m_bErr||this._fireEvent(SAXDriver.DOC_B),this._parseLoop(),this.m_bErr||this._fireEvent(SAXDriver.DOC_E),this.m_xml=null,this.m_iP=0},SAXDriver.prototype.setDocumentHandler=function(t){this.m_hndDoc=t},SAXDriver.prototype.setErrorHandler=function(t){this.m_hndErr=t},SAXDriver.prototype.setLexicalHandler=function(t){this.m_hndLex=t},SAXDriver.prototype.getColumnNumber=function(){return this.m_parser.getColumnNumber()},SAXDriver.prototype.getLineNumber=function(){return this.m_parser.getLineNumber()},SAXDriver.prototype.getMessage=function(){return this.m_strErrMsg},SAXDriver.prototype.getPublicId=function(){return null},SAXDriver.prototype.getSystemId=function(){return null},SAXDriver.prototype.getLength=function(){return this.m_parser.getAttributeCount()},SAXDriver.prototype.getName=function(t){return this.m_parser.getAttributeName(t)},SAXDriver.prototype.getValue=function(t){return this.m_parser.getAttributeValue(t)},SAXDriver.prototype.getValueByName=function(t){return this.m_parser.getAttributeValueByName(t)},SAXDriver.prototype._fireError=function(t){this.m_strErrMsg=t,this.m_bErr=!0,this.m_hndErr&&this.m_hndErr.fatalError&&this.m_hndErr.fatalError(this)},SAXDriver.prototype._fireEvent=function(t){var e,r,i=arguments,n=i.length-1;this.m_bErr||(SAXDriver.DOC_B==t?(r="startDocument",e=this.m_hndDoc):SAXDriver.DOC_E==t?(r="endDocument",e=this.m_hndDoc):SAXDriver.ELM_B==t?(r="startElement",e=this.m_hndDoc):SAXDriver.ELM_E==t?(r="endElement",e=this.m_hndDoc):SAXDriver.CHARS==t?(r="characters",e=this.m_hndDoc):SAXDriver.PI==t?(r="processingInstruction",e=this.m_hndDoc):SAXDriver.CD_B==t?(r="startCDATA",e=this.m_hndLex):SAXDriver.CD_E==t?(r="endCDATA",e=this.m_hndLex):SAXDriver.CMNT==t&&(r="comment",e=this.m_hndLex),e&&e[r]&&(0==n?e[r]():1==n?e[r](i[1]):2==n?e[r](i[1],i[2]):3==n&&e[r](i[1],i[2],i[3])))},SAXDriver.prototype._parseLoop=function(t){var e,t;for(t=this.m_parser;!this.m_bErr;)if(e=t.next(),e==XMLP._ELM_B)this._fireEvent(SAXDriver.ELM_B,t.getName(),this);else if(e==XMLP._ELM_E)this._fireEvent(SAXDriver.ELM_E,t.getName());else if(e==XMLP._ELM_EMP)this._fireEvent(SAXDriver.ELM_B,t.getName(),this),this._fireEvent(SAXDriver.ELM_E,t.getName());else if(e==XMLP._TEXT)this._fireEvent(SAXDriver.CHARS,t.getContent(),t.getContentBegin(),t.getContentEnd()-t.getContentBegin());else if(e==XMLP._ENTITY)this._fireEvent(SAXDriver.CHARS,t.getContent(),t.getContentBegin(),t.getContentEnd()-t.getContentBegin());else if(e==XMLP._PI)this._fireEvent(SAXDriver.PI,t.getName(),t.getContent().substring(t.getContentBegin(),t.getContentEnd()));else if(e==XMLP._CDATA)this._fireEvent(SAXDriver.CD_B),this._fireEvent(SAXDriver.CHARS,t.getContent(),t.getContentBegin(),t.getContentEnd()-t.getContentBegin()),this._fireEvent(SAXDriver.CD_E);else if(e==XMLP._COMMENT)this._fireEvent(SAXDriver.CMNT,t.getContent(),t.getContentBegin(),t.getContentEnd()-t.getContentBegin());else if(e==XMLP._DTD);else if(e==XMLP._ERROR)this._fireError(t.getContent());else if(e==XMLP._NONE)return},SAXStrings=function(){},SAXStrings.WHITESPACE=" 	\n\r",SAXStrings.QUOTES="\"'",SAXStrings.getColumnNumber=function(t,e){if(SAXStrings.isEmpty(t))return-1;e=e||t.length;var r=t.substring(0,e).split("\n");r[r.length-1];r.length--;var i=r.join("\n").length;return e-i},SAXStrings.getLineNumber=function(t,e){return SAXStrings.isEmpty(t)?-1:(e=e||t.length,t.substring(0,e).split("\n").length)},SAXStrings.indexOfNonWhitespace=function(t,e,r){if(SAXStrings.isEmpty(t))return-1;e=e||0,r=r||t.length;for(var i=e;r>i;i++)if(-1==SAXStrings.WHITESPACE.indexOf(t.charAt(i)))return i;return-1},SAXStrings.indexOfWhitespace=function(t,e,r){if(SAXStrings.isEmpty(t))return-1;e=e||0,r=r||t.length;for(var i=e;r>i;i++)if(-1!=SAXStrings.WHITESPACE.indexOf(t.charAt(i)))return i;return-1},SAXStrings.isEmpty=function(t){return null==t||0==t.length},SAXStrings.lastIndexOfNonWhitespace=function(t,e,r){if(SAXStrings.isEmpty(t))return-1;e=e||0,r=r||t.length;for(var i=r-1;i>=e;i--)if(-1==SAXStrings.WHITESPACE.indexOf(t.charAt(i)))return i;return-1},SAXStrings.replace=function(t,e,r,i,n){return SAXStrings.isEmpty(t)?"":(e=e||0,r=r||t.length,t.substring(e,r).split(i).join(n))},Stack=function(){this.m_arr=new Array},Stack.prototype.clear=function(){this.m_arr=new Array},Stack.prototype.count=function(){return this.m_arr.length},Stack.prototype.destroy=function(){this.m_arr=null},Stack.prototype.peek=function(){return 0==this.m_arr.length?null:this.m_arr[this.m_arr.length-1]},Stack.prototype.pop=function(){if(0==this.m_arr.length)return null;var t=this.m_arr[this.m_arr.length-1];return this.m_arr.length--,t},Stack.prototype.push=function(t){this.m_arr[this.m_arr.length]=t};

//xml dom
function convertEscapes(e){var t;for(t=-1;e.indexOf("&lt;",t+1)>-1;){var t=e.indexOf("&lt;",t+1),r=e.substr(0,t);r+="<",r+=e.substr(t+4,e.length),e=r}for(t=-1;e.indexOf("&gt;",t+1)>-1;){var t=e.indexOf("&gt;",t+1),r=e.substr(0,t);r+=">",r+=e.substr(t+4,e.length),e=r}for(t=-1;e.indexOf("&amp;",t+1)>-1;){var t=e.indexOf("&amp;",t+1),r=e.substr(0,t);r+="&",r+=e.substr(t+5,e.length),e=r}return e}function convertToEscapes(e){for(var t=-1;e.indexOf("&",t+1)>-1;){t=e.indexOf("&",t+1);var r=e.substr(0,t);r+="&amp;",r+=e.substr(t+1,e.length),e=r}for(t=-1;e.indexOf("<",t+1)>-1;){var t=e.indexOf("<",t+1),r=e.substr(0,t);r+="&lt;",r+=e.substr(t+1,e.length),e=r}for(t=-1;e.indexOf(">",t+1)>-1;){var t=e.indexOf(">",t+1),r=e.substr(0,t);r+="&gt;",r+=e.substr(t+1,e.length),e=r}return e}function _displayElement(e,t){if(null!=e&&"ELEMENT"==e.nodeType){var r=e.tagName,n="";n="<"+r;for(var i=e.getAttributeNames(),s=0;s<i.length;s++){var o=i[s];n=n+" "+o+"=",n=n+'"'+e.getAttribute(o)+'"'}if(n+=">",t+=n,null!=e.children)for(var h=e.children,s=0;s<h.length;s++){var d=h[s];if("COMMENT"==d.nodeType)t=t+"<!--"+d.content+"-->";else if("TEXT"==d.nodeType){var u=trim(d.content,!0,!0);t+=d.content}else if("CDATA"==d.nodeType){var u=trim(d.content,!0,!0);t=t+"<![CDATA["+u+"]]>"}else t=_displayElement(d,t)}return t=t+"</"+r+">"}}function firstWhiteChar(e,t){if(isEmpty(e))return-1;for(;t<e.length;){if(-1!=whitespace.indexOf(e.charAt(t)))return t;t++}return e.length}function isEmpty(e){return null==e||0==e.length}function trim(e,t,r){if(isEmpty(e))return"";null==t&&(t=!0),null==r&&(r=!0);var n=0,i=0,s=0,o=0;if(1==t)for(;s<e.length&&-1!=whitespace.indexOf(e.charAt(s++));)n++;if(1==r)for(o=e.length-1;o>=n&&-1!=whitespace.indexOf(e.charAt(o--));)i++;return e.substring(n,e.length-i)}function XMLDoc(e,t){return this.topNode=null,this.errFn=t,this.createXMLNode=_XMLDoc_createXMLNode,this.error=_XMLDoc_error,this.getUnderlyingXMLText=_XMLDoc_getUnderlyingXMLText,this.handleNode=_XMLDoc_handleNode,this.hasErrors=!1,this.insertNodeAfter=_XMLDoc_insertNodeAfter,this.insertNodeInto=_XMLDoc_insertNodeInto,this.loadXML=_XMLDoc_loadXML,this.parse=_XMLDoc_parse,this.parseAttribute=_XMLDoc_parseAttribute,this.parseDTD=_XMLDoc_parseDTD,this.parsePI=_XMLDoc_parsePI,this.parseTag=_XMLDoc_parseTag,this.removeNodeFromTree=_XMLDoc_removeNodeFromTree,this.replaceNodeContents=_XMLDoc_replaceNodeContents,this.selectNode=_XMLDoc_selectNode,this.selectNodeText=_XMLDoc_selectNodeText,this.source=e,this.parse()?null!=this.topNode?this.error("expected close "+this.topNode.tagName):!0:void 0}function _XMLDoc_createXMLNode(e){return new XMLDoc(e,this.errFn).docNode}function _XMLDoc_error(e){return this.hasErrors=!0,this.errFn?this.errFn("ERROR: "+e):this.onerror&&this.onerror("ERROR: "+e),0}function _XMLDoc_getTagNameParams(e,t){var r,n=-1,i=e.indexOf("["),s=[];return i>=0&&(r=e.indexOf("]"),r>=0?n=e.substr(i+1,r-i-1):t.error("expected ] near "+e),e=e.substr(0,i),isNaN(n)&&"*"!=n?(s=n.substr(1,n.length-1),s=s.split("="),s[1]&&(i=s[1].indexOf('"'),s[1]=s[1].substr(i+1,s[1].length-1),r=s[1].indexOf('"'),r>=0?s[1]=s[1].substr(0,r):t.error('expected " near '+e)),n=-1):"*"==n&&(n=-1)),[e,n,s[0],s[1]]}function _XMLDoc_getUnderlyingXMLText(){var e="";return e+='<?xml version="1.0"?>',null!=this.docNode?e=_displayElement(this.docNode,e):void 0}function _XMLDoc_handleNode(e){if("COMMENT"==e.nodeType&&null!=this.topNode)return this.topNode.addElement(e);if("TEXT"==e.nodeType||"CDATA"==e.nodeType)return null==this.topNode?""==trim(e.content,!0,!1)?!0:this.error("expected document node, found: "+e):this.topNode.addElement(e);if("OPEN"==e.nodeType||"SINGLE"==e.nodeType){var t=!1;return null==this.topNode?(this.docNode=e,e.parent=null,t=!0):t=this.topNode.addElement(e),t&&"SINGLE"!=e.nodeType&&(this.topNode=e),e.nodeType="ELEMENT",t}if("CLOSE"==e.nodeType){if(null==this.topNode)return this.error("close tag without open: "+e.toString());if(e.tagName!=this.topNode.tagName)return this.error("expected closing "+this.topNode.tagName+", found closing "+e.tagName);this.topNode=this.topNode.getParent()}return!0}function _XMLDoc_insertNodeAfter(e,t){var r=this.getUnderlyingXMLText(),n=e.getUnderlyingXMLText(),i=r.indexOf(n)+n.length,s=r.substr(0,i);s+=t.getUnderlyingXMLText(),s+=r.substr(i);var o=new XMLDoc(s,this.errFn);return o}function _XMLDoc_insertNodeInto(e,t){var r=this.getUnderlyingXMLText(),n=e.getUnderlyingXMLText(),i=n.indexOf(">")+1,s=r.indexOf(n)+i,o=r.substr(0,s);o+=t.getUnderlyingXMLText(),o+=r.substr(s);var h=new XMLDoc(o,this.errFn);return h}function _XMLDoc_loadXML(e){return this.topNode=null,this.hasErrors=!1,this.source=e,this.parse()}function _XMLDoc_parse(){var e=0;for(err=!1;!err;){var t,r,n="",i=this.source.indexOf("<",e),s=1;if(-1==i)break;t=i;var o=this.source.substring(e,t);if(0!=o.length&&(err=!this.handleNode(new XMLNode("TEXT",this,o))),i!=this.source.indexOf("<?",e))if(i!=this.source.indexOf("<!DOCTYPE",e)){if(i==this.source.indexOf("<!--",e)&&(s=4,n="--"),i==this.source.indexOf("<![CDATA[",e)&&(s=9,n="]]"),i=this.source.indexOf(n+">",i),-1==i)return this.error("expected closing tag sequence: "+n+">");r=i+n.length,o=this.source.substring(t+1,r);var h=this.parseTag(o);h&&(err=!this.handleNode(h)),e=r+1}else e=this.parseDTD(this.source,i+9),0==e&&(err=!0);else e=this.parsePI(this.source,e+2),0==e&&(err=!0)}return!err}function _XMLDoc_parseAttribute(e,t,r){for(;t<e.length&&-1!=whitespace.indexOf(e.charAt(t));)t++;if(t>=e.length)return t;for(var n=t;t<e.length&&"="!=e.charAt(t);)t++;var i="attributes must have values";if(t>=e.length)return this.error(i);for(var s=trim(e.substring(n,t++),!1,!0);t<e.length&&-1!=whitespace.indexOf(e.charAt(t));)t++;if(t>=e.length)return this.error(i);i="attribute values must be in quotes";var o=e.charAt(t++);if(-1==quotes.indexOf(o))return this.error(i);for(n=t;t<e.length&&e.charAt(t)!=o;)t++;return t>=e.length?this.error(i):r.addAttribute(s,trim(e.substring(n,t++),!1,!0))?t:0}function _XMLDoc_parseDTD(e,t){var r=e.indexOf(">",t);if(-1==r)return this.error("error in DTD: expected '>'");var n="",i=e.indexOf("[",t);for(-1!=i&&r>i&&(n="]");;){var s=e.indexOf(n+">",t);if(-1==s)return this.error("expected closing tag sequence: "+n+">");if(t=s+n.length+1,"]]>"!=e.substring(s-1,s+2))break}return t}function _XMLDoc_parsePI(e,t){var r=e.indexOf("?>",t);return r+2}function _XMLDoc_parseTag(e){if(0==e.indexOf("!--"))return new XMLNode("COMMENT",this,e.substring(3,e.length-2));if(0==e.indexOf("![CDATA["))return new XMLNode("CDATA",this,e.substring(8,e.length-2));var t=new XMLNode;if(t.doc=this,"/"==e.charAt(0)?(t.nodeType="CLOSE",e=e.substring(1)):t.nodeType="OPEN","/"==e.charAt(e.length-1)){if("CLOSE"==t.nodeType)return this.error("singleton close tag");t.nodeType="SINGLE",e=e.substring(0,e.length-1)}if("CLOSE"!=t.nodeType&&(t.attributes=new Array),"OPEN"==t.nodeType&&(t.children=new Array),e=trim(e,!0,!0),0==e.length)return this.error("empty tag");var r=firstWhiteChar(e,0);if(-1==r)return t.tagName=e,t;t.tagName=e.substring(0,r);for(var n=r;n<e.length;)if(n=this.parseAttribute(e,n,t),0==this.pos)return null;return t}function _XMLDoc_removeNodeFromTree(e){var t=this.getUnderlyingXMLText(),r=e.getUnderlyingXMLText(),n=t.indexOf(r),i=t.substr(0,n);i+=t.substr(n+r.length);var s=new XMLDoc(i,this.errFn);return s}function _XMLDoc_replaceNodeContents(e,t){var r=this.createXMLNode("<X>"+t+"</X>");return e.children=r.children,this}function _XMLDoc_selectNode(e){e=trim(e,!0,!0);var t,r,n,i,s,o,h,d,u;if(t=r=this.source?this.docNode:this,!e)return r;if(0==e.indexOf("/")&&(e=e.substr(1)),e=e.replace(n,""),o=e.split("/"),n=o[0],n&&(0==e.indexOf("/")&&(e=e.substr(1)),e=e.replace(n,""),i=_XMLDoc_getTagNameParams(n,this),n=i[0],s=i[1],h=i[2],d=i[3],r="*"==n?r.getElements():r.getElements(n),r.length))if(0>s){t=r;for(var a=0;a<t.length;){if(u=h&&t[a].getAttribute(h)!=d?!1:!0,u&&(r=t[a].selectNode(e)))return r;a++}}else if(s<r.length&&(r=r[s].selectNode(e)))return r}function _XMLDoc_selectNodeText(e){var t=this.selectNode(e);return null!=t?t.getText():null}function XMLNode(e,t,r){"TEXT"==e||"CDATA"==e||"COMMENT"==e?this.content=r:this.content=null,this.attributes=null,this.children=null,this.doc=t,this.nodeType=e,this.parent="",this.tagName="",this.addAttribute=_XMLNode_addAttribute,this.addElement=_XMLNode_addElement,this.getAttribute=_XMLNode_getAttribute,this.getAttributeNames=_XMLNode_getAttributeNames,this.getElementById=_XMLNode_getElementById,this.getElements=_XMLNode_getElements,this.getText=_XMLNode_getText,this.getParent=_XMLNode_getParent,this.getUnderlyingXMLText=_XMLNode_getUnderlyingXMLText,this.removeAttribute=_XMLNode_removeAttribute,this.selectNode=_XMLDoc_selectNode,this.selectNodeText=_XMLDoc_selectNodeText,this.toString=_XMLNode_toString}function _XMLNode_addAttribute(e,t){return this.attributes["_"+e]=t,!0}function _XMLNode_addElement(e){return e.parent=this,this.children[this.children.length]=e,!0}function _XMLNode_getAttribute(e){return null==this.attributes?null:this.attributes["_"+e]}function _XMLNode_getAttributeNames(){if(null==this.attributes){var e=new Array;return e}var t=new Array;for(var r in this.attributes)t[t.length]=r.substring(1);return t}function _XMLNode_getElementById(e){var t,r=this;if(r.getAttribute("id")==e)return r;for(var n=r.getElements(),i=0;i<n.length;){var s=n[i];if(t=s.getElementById(e),null!=t)break;i++}return t}function _XMLNode_getElements(e){if(null==this.children){var t=new Array;return t}for(var r=new Array,n=0;n<this.children.length;n++)"ELEMENT"!=this.children[n].nodeType||null!=e&&this.children[n].tagName!=e||(r[r.length]=this.children[n]);return r}function _XMLNode_getText(){if("ELEMENT"==this.nodeType){if(null==this.children)return null;for(var e="",t=0;t<this.children.length;t++){var r=this.children[t].getText();e+=null==r?"":r}return e}return"TEXT"==this.nodeType?convertEscapes(this.content):this.content}function _XMLNode_getParent(){return this.parent}function _XMLNode_getUnderlyingXMLText(){var e="";return e=_displayElement(this,e)}function _XMLNode_removeAttribute(e){if(null==e)return this.doc.error("You must pass an attribute name into the removeAttribute function");var t=this.getAttributeNames(),r=t.length,n=new Array;for(intLoop=0;intLoop<r;intLoop++)n[intLoop]=this.getAttribute(t[intLoop]);for(this.attributes=new Array,intLoop=0;intLoop<r;intLoop++)t[intLoop]!=e&&this.addAttribute(t[intLoop],n[intLoop]);return!0}function _XMLNode_toString(){return""+this.nodeType+":"+("TEXT"==this.nodeType||"CDATA"==this.nodeType||"COMMENT"==this.nodeType?this.content:this.tagName)}var whitespace="\n\r	 ",quotes="\"'";